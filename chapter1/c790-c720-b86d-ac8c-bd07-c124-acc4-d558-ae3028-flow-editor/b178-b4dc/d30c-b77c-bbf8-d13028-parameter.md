# 파라미터 (Parameters)

대화에서 발생한 값들을 key-value 형식으로 유지할때 사용합니다.

시스템에서 기본적으로 제공하는 예약 파라미터를 제외하고, 사용자는 파라미터 노드에서 원하는 값을 설정하여 [템플릿 기능](#템플릿-\(Template\))을 이용해 다음 노드의 입력값으로 사용할 수 있습니다.

## 예약 파라미터 (Reserved Parameters)

| 파라미터 명 | 설명 |
| :--- | :--- |
| `id` | 사용자의 대화 (Conversation) 를 식별하는 키 |
| `platform` | 사용자가 유입된 메신저 플랫폼을 나타내는 키<br>`web`, `kakao`, `kakaobiz`, `facebook`, `line`, `navertalk`, `wechat` |
| `userKey` | 각 메신저 플랫폼에서 설정된 사용자 식별 키 |
| `message` | 사용자가 마지막으로 입력한 텍스트 메시지 |

---

# 템플릿 (Template)

노드를 정적인 데이터들로만 작성하면, 동적으로 변경되는 사용자 파라미터에 대응하는 Flow를 작성할 수 없습니다.
동적으로 변하는 상황에 대응하기 위해, CLOSER에서는 각 Node를 작성할 때 사용할 수 있는 [템플릿 엔진](https://en.wikipedia.org/wiki/Template_processor) 을 제공합니다. 

템플릿은 정해진 위치에 파라미터를 주입할 수 있는 금형에 비유할 수 있습니다. 봇 빌더에서 동적인 파라미터가 필요한 공간에 중괄호(`\{\}`) 2개로 감싸진 파라미터 `\{\{파라미터명\}\}`을 입력해 놓으면, 실제 봇이 동작하면서 다음과 같은 결과를 반환합니다. 

#### 주어진 템플릿
{% markdown %}
```
입력하신 전화번호는 {{phoneNumber}} 입니다.
```
{% endmarkdown %}
#### 입력받은 파라미터
```json
{ 
    "phoneNumber": "01012345678"
}
```
#### 결과 
```
입력하신 전화번호는 01012345678입니다. 
```

템플릿 엔진은 사용자 정의 파라미터 외에도 [예약 파라미터](#예약-파라미터-\(Reserved-Parameters\))를 사용할 수 있으며, 더 다양한 로직을 작성할 수 있는 [템플릿 함수](#템플릿-함수-\(Template-Functions\))를 제공합니다.

## 템플릿 함수 (Template Functions)

| 파라미터 명 | 설명 |
| :--- | :--- |
| `DATE()` | 현재 시각 |
| `DATE(time)` | 입력된 ISO String / UNIX Timestamp 시각 |
| `RAND()` | 랜덤한 정수 |
| `RAND(n)` | 0 ~ n 사이의 랜덤한 정수 |
| `RAND(a, b)` | a ~ b 사이의 랜덤한 정수 |

예를 들어, 10부터 15 사이의 랜덤한 정수를 얻고 싶을 때는 다음과 같이 사용할 수 있습니다.

#### 템플릿

{% markdown %}
```
{{RAND(10, 15)}}
```
{% endmarkdown %}

#### 결과
```js
10 // 11, 12, 13, 14 또는 15
```

만일 템플릿에 맞는 파라미터가 존재하지 않는 경우, 템플릿 엔진은 `undefined` 값을 반환합니다.

#### 입력
{% markdown %}
```
{{존재하지_않는_파라미터}}가 입력되었습니다.
```
{% endmarkdown %}

#### 결과

```
undefined가 입력되었습니다.
```

이 경우, 작성된 Node가 제대로 동작하지 않을 수 있기 때문에, 템플릿 엔진 사용에는 주의가 필요합니다.